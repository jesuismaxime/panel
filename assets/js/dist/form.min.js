!function(o){o.fn.date=function(){return this.each(function(){if(o(this).data("pikaday"))return o(this);var e=o(this).attr("type","text"),a=e.next(),n=e.data("format"),t=e.val(),r=t?moment(t).format(n):null;if(e.attr("placeholder",n),e.val(r),e.is("[readonly]"))return!1;e.on("change",function(){var t=e.val();t?a.val(moment(t,n).format("YYYY-MM-DD")):a.val("")});var i=new Pikaday({field:this,firstDay:1,format:n,i18n:e.data("i18n"),onSelect:function(t){a.val(moment(t).format("YYYY-MM-DD"))}});o(this).data("pikaday",i)})}}(jQuery),function(a){a.fn.imagefield=function(){return this.each(function(){var t=a(this);if(t.data("imagefield"))return!0;t.data("imagefield",!0);var n=t.find("select"),r=t.find(".input-preview figure"),i=r.parent("a");n.on("keydown change",function(){var t=n.find("option:selected"),e=t.data("url"),a=t.data("thumb");""===t.val()&&(e="#"),a?r.attr("style","background-image: url("+a+")"):r.attr("style","background-image: none"),i.attr("href",e)}).trigger("change"),t.find(".input-preview").on("click",function(){if("#"==a(this).attr("href"))return!1}),t.find(".input").droppable({hoverClass:"over",accept:a(".sidebar .draggable-file"),drop:function(t,e){a(this).find("select").val(e.draggable.data("helper")).trigger("change")}})})}}(jQuery),function(o){var e=function(t){var e=o(t),a=e.data("style"),n=e.data("api"),r=e.data("sortable"),i="table"==a?e.find(".structure-table tbody"):e.find(".structure-entries");if(!1===r)return!1;i.sortable({helper:function(t,e){return e.children().each(function(){o(this).width(o(this).width())}),e.addClass("structure-sortable-helper")},update:function(){var a=[];o.each(o(this).sortable("toArray"),function(t,e){a.push(e.replace("structure-entry-",""))}),o.post(n,{ids:a},function(){app.content.reload()})}})};o.fn.structure=function(){return this.each(function(){if(o(this).data("structure"))return o(this);var t=new e(this);return o(this).data("structure",t),o(this)})}}(jQuery),function(i){i.fn.counter=function(){return this.each(function(){var t=i(this);if(t.data("counter"))return t;var e=t.parent(".field").find(".input"),a=i.trim(e.val()).length,n=e.data("max"),r=e.data("min");e.keyup(function(){a=i.trim(e.val()).length,t.text(a+(n?"/"+n:"")),n&&n<a||r&&a<r?t.addClass("outside-range"):t.removeClass("outside-range")}).trigger("keyup"),t.data("counter",!0)})}}(jQuery),function(u){u.fn.editor=function(){return this.each(function(){if(u(this).data("editor"))return u(this);var o=u(this),t=o.parent().find(".field-buttons");o.autosize(),t.find(".btn").on("click.editorButton",function(t){o.focus();var e=u(this);if(e.data("action"))app.modal.open(e.data("action"),window.location.href);else{var a=o.getSelection(),n=e.data("tpl"),r=e.data("text");0<a.length&&(r=a);var i=n.replace("{text}",r);o.insertAtCursor(i),o.trigger("autosize.resize")}return!1}),t.find("[data-editor-shortcut]").each(function(t,e){var a=u(this).data("editor-shortcut"),n=function(t){return u(e).trigger("click"),!1};o.bind("keydown",a,n),a.match(/meta\+/)&&o.bind("keydown",a.replace("meta+","ctrl+"),n)}),o.data("editor",!0)})}}(jQuery),function(a){a.fn.urlfield=function(){return this.each(function(){var e=a(this);if(!e.data("urlfield")){e.data("urlfield",!0);var t=e.next(".field-icon");t.css({cursor:"pointer","pointer-events":"auto"}),t.on("click",function(){var t=a.trim(e.val());""!==t&&e.is(":valid")?window.open(t):e.focus()})}})}}(jQuery);